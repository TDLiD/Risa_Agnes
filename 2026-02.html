<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026-02 Future Horizon</title>
    <script src="music/music_list.js"></script>
    <style>
        :root { --accent:#00ffa3; --glass: rgba(15, 23, 42, 0.8); }
        body { 
            margin:0; background:#020205; color:white; 
            font-family:'Inter',sans-serif; overflow:hidden; 
            height: 100vh; perspective: 1000px;
        }

        /* ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ */
        #bg-canvas { position: fixed; inset: 0; z-index: -1; opacity: 0.4; }

        .nav { position:fixed; top:30px; left:30px; z-index:2000; }
        .btn { 
            padding:12px 24px; border:1px solid var(--accent); color:var(--accent); 
            text-decoration:none; background:rgba(0,0,0,0.6); border-radius:30px; 
            font-weight:bold; backdrop-filter:blur(10px); transition: 0.3s;
        }

        /* ğŸ–¼ï¸ ìƒˆë¡œìš´ íš¨ê³¼: 3D Floating ì¹´ìŠ¤ì¼€ì´ë“œ */
        #gallery-viewport {
            width: 100%; height: 100%;
            overflow-y: auto; overflow-x: hidden;
            scroll-behavior: smooth;
            perspective: 2000px;
            padding: 200px 0;
        }
        #gallery-viewport::-webkit-scrollbar { display: none; }

        .gallery-track {
            display: flex; flex-wrap: wrap; justify-content: center;
            gap: 40px; transform-style: preserve-3d;
            padding: 0 10vw;
        }

        .photo-card {
            width: 280px; aspect-ratio: 1/1;
            border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden; cursor: pointer;
            transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: var(--glass);
            position: relative;
        }

        /* ì§€ê·¸ì¬ê·¸ ê¹Šì´ ë°°ì¹˜ */
        .photo-card:nth-child(3n) { transform: translateZ(100px) translateY(-20px); }
        .photo-card:nth-child(3n+1) { transform: translateZ(-150px) translateY(40px); }
        .photo-card:nth-child(3n+2) { transform: translateZ(50px); }

        .photo-card img { width:100%; height:100%; object-fit:cover; opacity: 0.6; transition: 0.5s; }
        .photo-card:hover { transform: translateZ(300px) rotateY(10deg) !important; z-index: 100; border-color: var(--accent); }
        .photo-card:hover img { opacity: 1; transform: scale(1.1); }

        /* ğŸ¼ ìŒì•… í”Œë ˆì´ì–´ (old.html ìŠ¤íƒ€ì¼ ìœ ì§€) */
        #player-container { 
            position: fixed; bottom: 30px; right: 30px; width: 260px; 
            background: var(--glass); backdrop-filter: blur(20px); 
            border: 1px solid rgba(0, 255, 163, 0.2); border-radius: 24px; 
            z-index: 2000; padding: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        .player-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        #track-name { font-size: 11px; font-weight: bold; color: var(--accent); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .controls { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .controls button { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px; padding: 8px 0; cursor: pointer; font-size: 10px; }
        
        /* ëª¨ë‹¬ */
        #modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 3000; backdrop-filter: blur(15px); }
        #modal img { max-width: 85%; max-height: 80%; border-radius: 15px; border: 1px solid var(--accent); }
    </style>
</head>
<body>
    <nav class="nav"><a href="index.html" class="btn">â† EXIT</a></nav>

    <div id="gallery-viewport">
        <div class="gallery-track" id="gallery-track"></div>
    </div>

    <div id="player-container">
        <div class="player-header">
            <div id="track-name">READY</div>
        </div>
        <div class="controls">
            <button onclick="prevTrack()">â—â—</button>
            <button id="play-btn" onclick="togglePlay()">PLAY</button>
            <button onclick="stopTrack()">â– </button>
            <button onclick="nextTrack()">â–·â–·</button>
        </div>
        <audio id="bg-music"></audio>
    </div>

    <div id="modal" onclick="this.style.display='none'"><img id="modal-img"></div>

    <script>
        // 1. ê°¤ëŸ¬ë¦¬ ë¡œì§ (Cascading íš¨ê³¼)
        async function loadGallery() {
            const res = await fetch('images/photos.json');
            const data = await res.json();
            const list = data["2026_02"];
            const track = document.getElementById('gallery-track');

            list.forEach((imgName, i) => {
                const card = document.createElement('div');
                card.className = 'photo-card';
                // ê°œë³„ ì¹´ë“œì— ë¯¸ì„¸í•œ ê°ë„ ëœë¤ ë¶€ì—¬
                const rot = (Math.random() - 0.5) * 10;
                card.style.setProperty('--rot', `${rot}deg`);
                
                card.innerHTML = `<img src="images/2026-02/${imgName}" loading="lazy">`;
                card.onclick = () => {
                    document.getElementById('modal-img').src = card.querySelector('img').src;
                    document.getElementById('modal').style.display = 'flex';
                };
                track.appendChild(card);
            });
        }

        // 2. ìŒì•… í”Œë ˆì´ì–´ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
        const tracks = typeof EXTERNAL_TRACKS !== 'undefined' ? EXTERNAL_TRACKS : [];
        let currentIdx = 0;
        const audio = document.getElementById('bg-music');
        const playBtn = document.getElementById('play-btn');
        const trackName = document.getElementById('track-name');

        function loadTrack(idx, auto = true) {
            if (!tracks.length) return;
            currentIdx = idx;
            audio.src = `music/${tracks[idx]}`;
            trackName.innerText = tracks[idx].replace('.mp3','').replace(/_/g,' ');
            if (auto) audio.play();
            playBtn.innerText = audio.paused ? "PLAY" : "PAUSE";
        }

        function togglePlay() { 
            if (audio.paused) { audio.play(); playBtn.innerText = "PAUSE"; }
            else { audio.pause(); playBtn.innerText = "PLAY"; }
        }
        function nextTrack() { loadTrack((currentIdx + 1) % tracks.length); }
        function prevTrack() { loadTrack((currentIdx - 1 + tracks.length) % tracks.length); }
        function stopTrack() { audio.pause(); audio.currentTime = 0; playBtn.innerText = "PLAY"; }
        audio.onended = nextTrack;

        // ë§ˆìš°ìŠ¤ íœ ì— ë”°ë¥¸ 3D ê¸°ìš¸ê¸° íš¨ê³¼
        window.addEventListener('scroll', () => {
            const cards = document.querySelectorAll('.photo-card');
            cards.forEach(card => {
                const rect = card.getBoundingClientRect();
                const mid = window.innerHeight / 2;
                const dist = (rect.top + rect.height/2) - mid;
                card.style.transform = `rotateX(${dist * 0.05}deg)`;
            });
        }, true);

        window.onload = () => {
            loadGallery();
            loadTrack(0, false);
        };
    </script>
</body>
</html>